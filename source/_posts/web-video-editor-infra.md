---
title: 云视频剪辑配齐工具实践复盘（架构篇）
date: '2021-06-06'
---

随着业务规模的扩大，业务方对提高生产效率的需求日加激烈。尤其笔者所在业务部门负责的 AI 录播课，主讲老师需在课前对录播视频进行上传、根据课程内容插入锚点和编辑相关互动的内容，因此在夏季课来临之前，我们针对用户的痛点提出改造现有的 AI 录播课视频配齐工具。

## 需求背景

1. 颗粒化需求

- 过去 AI 课视频都是以单个完整的视频（大小约 4GB 左右）一次性上传到云服务器，再通过 Web 网页的配齐工具根据播放器时间插入锚点。在公司网络下，由于各家分公司的经营情况不同，大概至少需要 30 分钟到 60 分钟不等。对于配齐的老师来说，在上传等待这段时间是无法处理其他工作的，唯有上传成功后，才能进行视频配齐的工作。
- 如果主讲老师在视频配齐阶段发现视频中出现错误或有课程内容需要修改，那么就需要视频编辑部门编辑后，重新上传和配齐，那么之前所完成的工作就需要重新开始，整个流程会让老师做了很多无用功，且消耗大量的时间。

2. 灵活度需求

- 全国不同省份地区的学生水平存在着差距，课堂老师希望通过增加附加题、白板讲解、拓展讲解等可灵活运用的环节，让课堂老师根据课堂实际情况，自行决定是否播放相关的片段。

最终产品提出上述需求的解决方案：分段上传 + 自由组合。

<!-- more -->

下图为原版 AI 录播课视频配齐工具

![web-video-editor-img1](http://img.mrsingsing.com/web-video-editor-img1.png)

从上图可见原版的配器工具相对比较简陋，通过播放器进度指针的位置插入锚点，然后通过表单配置相关锚点的类型、持续时长、内容等等。

## 架构设计

如下图所示，AI 录播课视频配齐工具的整体架构由三部分组成：

![web-video-editor-infra-1](http://img.mrsingsing.com/web-video-editor-infra-img1.png)

- 客户端（前端）：负责用户交互操作，包括视频素材导入、视频剪辑和完整视频的即时预览
- 服务端（后端）：负责视频配置数据与集团内部其他服务的数据处理，以及与提供云剪辑服务的云平台进行任务调度
- 云平台：提供基础支撑，例如视频文件存储、视频编解码、视频截图、视频合成、视频加密等等

前端部分实际上只有一个页面，由三个区域组成，但事实上包含的功能并不少：

![web-video-editor-infra-2](http://img.mrsingsing.com/web-video-editor-infra-img2.png)

架构和功能都相对复杂，在开发中也确实遭遇不少棘手的技术难点，下一篇我将详述这些细节的实现。

## 参考资料

- [爱奇艺云剪辑 Web 端的技术实现](https://www.infoq.cn/article/M2JR9t57w75MvItd7FF3)
