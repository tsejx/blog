---
title: åŸºäº roadhog^2.x çš„åå°é¡¹ç›®æ„å»ºæ€§èƒ½ä¼˜åŒ–
date: '2019-01-20'
description: ç»“åˆæ„å»ºå·¥å…·çš„æè‡´åŒ–è¿ç”¨å’Œæ„å»ºäº§ç‰©çš„ç ”ç©¶åˆ†æå¯¹ roadhog çš„é¡¹ç›®è¿›è¡Œæ„å»ºä¼˜åŒ–
---

## æŠ€æœ¯é€‰å‹

ç›®å‰æˆ‘å¸åå°ç³»ç»Ÿé‡‡ç”¨åŸºäº [Webpack](https://github.com/webpack/webpack) ä¸ºåº•å±‚å°è£…çš„æ‰“åŒ…å·¥å…· [roadhog](https://github.com/sorrycc/roadhog)ã€‚å¼€å‘è€…é€šè¿‡å·¥å…·æš´éœ²çš„æœ‰é™çš„å¯é…ç½®å‚æ•°ï¼Œå¯ä»¥ç®€å•æ˜äº†åœ°é’ˆå¯¹é¡¹ç›®éœ€è¦è¿›è¡Œè‡ªå®šä¹‰é…ç½®ã€‚è¯¥æ¬¾å·¥å…·çš„ç›®çš„å¾ˆæ˜ç¡®ï¼Œå°±æ˜¯ä¸ºäº†ç®€åŒ– webpack çš„é…ç½®ã€‚è¿™å¯¹äºå…¥é—¨çº§åˆ«çš„å·¥ç¨‹å¸ˆæ˜¯éå¸¸å‹å¥½çš„ï¼Œå› ä¸ºé™ä½äº†å­¦ä¹  webpack çš„æˆæœ¬ï¼Œå…å»æ£é¼“ webpack å¤æ‚çš„é…ç½®ï¼Œæ–¹ä¾¿å¼€å‘è€…å¿«é€Ÿè¿›å…¥å¼€å‘æµç¨‹ã€‚

ä»ç›®å‰é¡¹ç›®ç‰ˆæœ¬çš„ `package.json` å‘ä¸Šå±‚ä¾èµ–æº¯æºå¯ä»¥å¾—å‡ºè¿™æ ·çš„ä¾èµ–å…³ç³»ï¼š

> roadhog^2.4.2 => af-webpack^0.23.0-beta.1 => webpack^3.56

roadhog åŸºäº [`umi/af-webpack`](https://github.com/umijs/umi/tree/master/packages/af-webpack) ä½œä¸ºåº•å±‚ã€‚ä»ç¤¾åŒºåé¦ˆçš„ä¿¡æ¯å¾—çŸ¥ï¼Œç°æ—¶ï¼ˆ2019.1ï¼‰ä½œè€…çš„å·¥ä½œé‡ç‚¹éƒ½åœ¨ [umi](https://github.com/umijs/umi)ï¼Œè€Œ roadhog æ— æ‰“ç®—è¿­ä»£å‡çº§çš„æ‰“ç®—ã€‚å³ä¾¿å°† roadhog å‡çº§è‡³æœ€æ–°ç‰ˆæœ¬ï¼Œæ‰€ä¾èµ–çš„åº•å±‚ webpack çš„ç‰ˆæœ¬ä¹Ÿåªæ˜¯ 3.5.6ï¼Œwebpack4+ çš„ä¼˜åŒ–é…ç½®å‡æ— æ³•ä½¿ç”¨ã€‚ç”±äºå·¥å…·æ–‡æ¡£æä¾›ä¿¡æ¯æœ‰é™ï¼Œå› æ­¤è¦å°†ä¼˜åŒ–è¿›è¡Œåˆ°æè‡´ä»æºç ä¾èµ–ç€æ‰‹æ¨åŠ¨é¡¹ç›®æ„å»ºä¼˜åŒ–æ˜¯å…ä¸äº†çš„å·¥ä½œã€‚

## æ„å»ºç°å†µåˆ†æ

> ç‰ˆæœ¬ release/2.29.0

**åˆ†æææ–™**

- é€šè¿‡ [webpack-bundle-analyzer](https://github.com/webpack-contrib/webpack-bundle-analyzer) å¯¹æ‰“åŒ…æ¨¡å—è¿›è¡Œå¯è§†åŒ–åˆ†æ
- å¯¹æ‰“åŒ…å‡ºæ¥åçš„èµ„æºæ–‡ä»¶è¿›è¡Œåˆ†æ
- é¡¹ç›®ç»„ç»‡ç»“æ„åˆ†æ

**æ„å»ºæƒ…å†µåˆ†æ**

- æ„å»ºå†…å­˜å ç”¨è¿‡é«˜ï¼š130% éœ€è¦ç»™ node é…ç½®æ›´å¤šå†…å­˜é˜²æ­¢å†…å­˜æº¢å‡ºå¯¼è‡´å¤±è´¥
- æ„å»ºè¿›åº¦è§‚å¯Ÿï¼šå¡åœ¨ 10%ã€86%ã€**91%**
- æ„å»ºä½¿ç”¨æ—¶é—´ï¼š407s 366s 386s 380s 372s => å¹³å‡ 382s
- é™æ€èµ„æºæ•°é‡ï¼šåˆ†å‰²æˆå…± 92 ä¸ªèµ„æºæ–‡ä»¶ï¼ˆåŒ…æ‹¬å…¥å£æ–‡ä»¶ï¼Œä½†é™¤å»é»˜è®¤æ‹·è´è¾“å‡ºçš„æ–‡ä»¶ï¼‰
- é™æ€èµ„æºå¤§å°
  - Startï¼šæ€» 150MBï¼Œå¹³å‡ï¼Œæœ€å¤§ 5.05MB
  - Parsedï¼šæ€» 88MBï¼Œå¹³å‡ï¼Œæœ€å¤§ 2.48MB
  - Gzippedï¼šæ€» 25MBï¼Œå¹³å‡ï¼Œæœ€å¤§ 686.48KB

| é™æ€èµ„æºå¤§å° | æ•°é‡ |
| ------------ | ---- |
| >2MB         | 5    |
| >1MB         | 24   |
| >500KB       | 60   |

## é¡¹ç›®æ„å»ºä¼˜åŒ–æ–¹æ¡ˆ

æŒ‰ç…§ [Webpack æ„å»ºæ€§èƒ½ä¼˜åŒ–æ¢ç´¢](https://github.com/pigcan/blog/issues/1) æä¾›çš„æ€è·¯ï¼Œå¯ä»¥ä»å››ä¸ªç»´åº¦ç€æ‰‹é¡¹ç›®æ„å»ºçš„ä¼˜åŒ–ï¼š

- ä»ç¯å¢ƒç€æ‰‹ï¼Œæå‡ä¸‹è½½ä¾èµ–é€Ÿåº¦
- ä»é¡¹ç›®è‡ªèº«ç€æ‰‹ï¼Œä»£ç ç»„ç»‡æ˜¯å¦åˆç†ï¼Œä¾èµ–ä½¿ç”¨æ˜¯å¦åˆç†ï¼Œåé¢æå‡æ•ˆç‡
- ä» Webpack è‡ªèº«ä¼˜åŒ–æ‰‹æ®µç€æ‰‹ï¼Œä¼˜åŒ–é…ç½®ï¼Œæå‡ Webpack æ•ˆç‡
- ä» Webpack å¯èƒ½å­˜åœ¨çš„ä¸è¶³ç€æ‰‹ï¼Œä¼˜åŒ–ä¸è¶³ï¼Œè¿›ä¸€æ­¥æå‡æ•ˆç‡

### å»é™¤åºŸå¼ƒä¾èµ–

è§‚å¯Ÿ `package.json`ï¼Œå‘ç°ä¸€äº›é¡¹ç›®ä¸­åºŸå¼ƒçš„ä¾èµ–å¹¶æ²¡æœ‰åŠæ—¶å¤„ç†ï¼Œå› æ­¤æŠŠæ— ç”¨çš„å’Œé‡å¤å®‰è£…çš„ä¾èµ–å»é™¤ã€‚

### æå–ç¬¬ä¸‰æ–¹å…¬å…±æ¨¡å—

æ­¤å‰é¡¹ç›®ä¸­é¡µé¢ä»£ç æ ¹æ®è·¯ç”±æŒ‰éœ€åŠ è½½ï¼Œæ¯ä¸ªé¡µé¢ route å’Œ model å¼•ç”¨çš„ç¬¬ä¸‰æ–¹æ¨¡å—ï¼Œä¾‹å¦‚ `react`ã€`dva`ã€`query-string`ã€`antd`ã€`moment` ç­‰ï¼Œéƒ½ä¼šåœ¨å„è‡ªçš„é¡µé¢ä¸­é‡å¤æ‰“åŒ…ä¸€ä»½ï¼Œè¿™å°±å¯¼è‡´æ ¹æ®é¡µé¢åˆ†å‰²çš„èµ„æºæ–‡ä»¶å°ºå¯¸è¾ƒå¤§ï¼Œå†—ä½™ä»£ç è¾ƒå¤šã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé¡¹ç›®ä¸­ä½¿ç”¨çš„ [AntDesign](https://github.com/ant-design/ant-design) ç»„ä»¶ï¼Œå°½ç®¡é€šè¿‡ [babel-plugin-import](https://github.com/ant-design/babel-plugin-import) å®ç°äº†ç»„ä»¶æ¨¡å—çš„æŒ‰éœ€åŠ è½½ï¼Œé¡µé¢å¼•ç”¨å¹¶ä¸ä¼šå°†å®Œæ•´çš„ AntDesign å¼•å…¥ã€‚ä½†æ˜¯ç”±äºå¼€å§‹æ—¶å€™å¤§éƒ¨åˆ†é¡µé¢éƒ½ä¸ä¼šä»é›¶å¼€å§‹å†™ï¼Œè€Œæ˜¯ä¼šé€‰æ‹©ç§»æ¤ç›¸ä¼¼é¡µé¢çš„é€»è¾‘å†åŠ ä»¥ä¿®æ”¹ï¼Œå› æ­¤ä¼šå¯¼è‡´ç›¸å½“ä¸€éƒ¨åˆ†é¡µé¢ä¼šå°†æ²¡æœ‰ä½¿ç”¨åˆ°çš„ç»„ä»¶è¿›è¡Œæ‰“åŒ…ï¼ŒåŒæ ·ä¼šé€ æˆå†—ä½™ã€‚

å› æ­¤ï¼Œæ•´ä¸ªé¡¹ç›®çš„æ€§èƒ½ä¼˜åŒ–å¿…ç„¶ä»èµ„æºä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“ç€æ‰‹ï¼Œæå‰ç¼–è¯‘æå–ã€‚

åˆ†æ `package.json` å¯ä»¥å¾—çŸ¥æ•´ä¸ªé¡¹ç›®ä¾èµ–ä¸»è¦æœ‰å‡ ä¸ªéƒ¨åˆ†ï¼š

- [antd](https://github.com/ant-design/ant-design) åŸºç¡€ UI ç»„ä»¶åº“ ğŸ“Œ
- [dva](https://github.com/dvajs/dva) æ•°æ®ç®¡ç†æ¡†æ¶
- [moment](https://github.com/moment/moment) æ—¶é—´æ“ä½œå·¥å…·åº“ ğŸ“Œ
- [ali-oss](https://github.com/ali-sdk/ali-oss) é˜¿é‡Œäº‘ OSS æ’ä»¶
- [react](https://github.com/facebook/react) ç•Œé¢æ¡†æ¶
- react-dom
- react-router-dom
- universal-cookie
- ...ç­‰ç­‰

roadhog æš´éœ²äº† commons å‚æ•°å¯¹åº” Webpack ä¸­ plugins çš„å¤šä¸ª `webpack.CommonsChunkPlugin` å®ä¾‹ã€‚ä¸‹é¢æœ‰ä¸¤ç§å¯é€‰æ‹©çš„æ–¹æ¡ˆä¾›å®ç°ï¼š

- è¢«è‡³å°‘å›ºå®šä¸ªæ•°ï¼ˆé»˜è®¤ä¸¤ä¸ªï¼‰ entry/page ä¾èµ–å³æå–å…¬å…±ï¼Œè¿™æ · common å…¬å…±æ¨¡å—ä¼šæ¯”è¾ƒå¤§ï¼Œé¡¹ç›®æ•´ä½“å°ºå¯¸æœ€å°ï¼Œä½†é¡µé¢é¦–å±æ¸²æŸ“éœ€è¦åŠ è½½çš„èµ„æºå°ºå¯¸ä¼šæ¯”è¾ƒå¤§
- è¢«æ‰€æœ‰ entry/page ä¾èµ–æ‰æå–ä¸ºå…¬å…±ï¼Œè¿™æ · common å…¬å…±æ¨¡å—æ¯”è¾ƒå°ï¼Œé¡¹ç›®æ•´ä½“å°ºå¯¸è¾ƒå¤§

æœ€ç»ˆå†³å®šå°†æ‰€æœ‰ä¾èµ–çš„ç¬¬ä¸‰æ–¹æ¨¡å—æå‰æ‰“åŒ…ï¼Œåœ¨ç”¨æˆ·è®¿é—®é¡µé¢æ—¶éœ€è¦å°†åŸºç¡€å·¥å…·å’ŒåŸºç¡€ç»„ä»¶çš„æ‰“åŒ…æ–‡ä»¶å…ˆåŠ è½½ï¼Œåç»­ç”¨æˆ·ç•Œé¢èµ„æºæ–‡ä»¶åŠ è½½å°±ä¼šç›¸å¯¹å¦ä¸€ç§æ–¹æ¡ˆä¼šæ›´åŠ å¿«é€Ÿã€‚

ç›¸å…³æ‰©å±•ï¼š

- [è¯¦è§£ CommonsChunkPlugin çš„é…ç½®å’Œç”¨æ³•](https://segmentfault.com/a/1190000012828879)

- [webpack.optimize.CommonsChunkPlugin è¯¦è§£](https://juejin.im/post/5c2205e15188257507558c5a)

- [webpackã€manifestã€runtimeã€ç¼“å­˜ä¸ CommonsChunkPlugin](https://www.jianshu.com/p/95752b101582)

### ç¬¬ä¸‰æ–¹æ¨¡å—ä¸åŒå…¼å®¹åº“é‡å¤æ‰“åŒ…

![ä¼˜åŒ–å‰æ‰“åŒ…ç»“æœ](http://img.mrsingsing.com/roadhog-performance-build-analyze.jpg)

vendor æå–ç¬¬ä¸‰æ–¹æ¨¡å—åï¼Œå‘ç°å‡ ä¸ªæ¯”è¾ƒå¤§çš„é¡µé¢èµ„æºæ–‡ä»¶é‡Œä»ç„¶å­˜åœ¨ antd.lib ç»„ä»¶åº“çš„ä»£ç ï¼Œè€Œä¸”è¿™äº› `ant.lib` éƒ½æ˜¯å®Œæ•´ä¸€ä¸ªæ¨¡å—è¢«æ‰“åŒ…è¿›äº†è¿™äº›é¡µé¢å½“ä¸­ï¼Œä½†å…¶å® AntDesign å·²ç»è¢«æˆ‘å®Œæ•´å•ç‹¬åœ°æ‰“åŒ…æˆå¦å¤–ä¸€ä¸ªæ–‡ä»¶äº†ï¼Œè¿™ä¸ªæ‰“åŒ…çš„æ–‡ä»¶æ˜¯ç”± `ant.es` æ‰“åŒ…å‡ºæ¥çš„ã€‚

- antd.es
- antd.lib

é€šè¿‡å¯¹æ‰“åŒ…åçš„æ–‡ä»¶ä»¥åŠä¸šåŠ¡ä»£ç çš„æ£€æŸ¥ï¼Œå‘ç°æ˜¯å¼•ç”¨ Antd ç»„ä»¶åº“å‘ç”Ÿäº†é—®é¢˜ï¼Œç”±äºä½¿ç”¨äº† webpack-plugin-import æ’ä»¶ï¼Œå°† Antd ä¸­åä¸º es çš„ç»„ä»¶åº“æŒ‰éœ€åŠ è½½å¹¶é€šè¿‡ babel è½¬åŒ–ç‹¬ç«‹æ‰“åŒ…æˆ vendorï¼Œå› æ­¤å½“ä½¿ç”¨ `import {message} from "antd/lib/index"` è¿™ç§å†™æ³•çš„æ—¶å€™ï¼Œå½“å‰é¡µé¢ä¼šå°† Antd lib ç›®å½•ä¸‹çš„ç»„ä»¶å…¨éƒ¨æ‰“åŒ…ï¼Œé€ æˆé¡µé¢æ‰“åŒ…æ–‡ä»¶è‡ƒè‚¿ã€‚

ä¹¦å†™è§„èŒƒ
ä½¿ç”¨äº† extraBabelPlugins å°±ä¼šæŒ‰éœ€åŠ è½½

```js
// wrong
import { message } from 'antd/lib/index';

// good
import { message } from 'antd';
```

### å¿½ç•¥ moment è¯­è¨€åŒ…çš„æ‰“åŒ…

![å¿½ç•¥ moment è¯­è¨€åŒ…](http://img.mrsingsing.com/roadhog-performance-moment-locale.jpg)

æ‰“åŒ…å moment åŒ…çš„ä½“ç§¯æ¯”è¾ƒå¤§ï¼Œå…¶ä¸­ locale è¯­è¨€åŒ…éƒ¨åˆ†å æ®äº†æ¯”è¾ƒå¤§çš„ä½“ç§¯ï¼Œç”±äºæˆ‘ä»¬çš„é¡¹ç›®æ²¡æœ‰å›½é™…åŒ–éœ€æ±‚ï¼Œå› æ­¤å¯ä»¥é€šè¿‡é…ç½® roadhog æä¾›çš„ `ignoreMomentLocale: true` å‡å°‘æ‰“åŒ…å‡ºæ¥çš„ vendor å°ºå¯¸ã€‚

ä½†æ˜¯ï¼Œå¦‚æœé¡¹ç›®ä¸­ä½¿ç”¨åˆ° AntDesign ç»„ä»¶ï¼Œå¹¶ä¸”ä½¿ç”¨åˆ°æ—¶é—´é€‰æ‹©ç»„ä»¶ `date-picker`ï¼ˆé»˜è®¤æ˜¯è‹±æ–‡æ–‡æ¡ˆï¼‰ï¼Œé‚£ä¹ˆè¿™é‡Œéœ€è¦åšä¸€äº›å¤„ç†ä»¥ä½¿é¡¹ç›®ä¸­ç»„ä»¶èƒ½å¤Ÿæ˜¾ç¤ºä¸­æ–‡ã€‚

æˆ‘æ˜¯åœ¨é¡¹ç›®æœ€ä¸Šå±‚ï¼Œå•ç‹¬å¼•å…¥ moment çš„ä¸­æ–‡è¯­è¨€åŒ…ã€‚

```js
import moment from 'moment';
import 'moment/locale/zh-cn';

moment.locale('zh-cn');
```

è¿™æ ·é¡¹ç›®ä¸­ä½¿ç”¨åˆ° moment å·¥å…·åº“çš„ `date-picker` éƒ½ä¼šæ˜¾ç¤ºä¸­æ–‡æ–‡æ¡ˆã€‚

### å‹ç¼©è€—æ—¶

é¡¹ç›®æ„å»ºè¿‡ç¨‹ä¼šå¡åœ¨ 91%ï¼Œé€šè¿‡æŸ¥é˜…ç›¸å…³èµ„æ–™å’Œäº†è§£ç¤¾åŒºåé¦ˆåï¼Œæ˜ç¡®åŸå› ä¸ºè¯¥é˜¶æ®µ Webpack æ­£åœ¨å¯¹ä»£ç è¿›è¡Œæ··æ·†å‹ç¼©æ“ä½œï¼Œä½†åŒæ—¶ç”±äº Webpack çš„å‹ç¼©æ’ä»¶ UglifyJS æ— æ³•å¯¹ ES6+ çš„ä»£ç è¿›è¡Œå‹ç¼©ï¼Œéœ€è¦ä½¿ç”¨ [babel-minify](https://github.com/babel/minify) è·å–æ›´å¥½çš„ treeshaking æ•ˆæœï¼ˆè™½ç„¶ Webpack4 å·²ç»æ”¯æŒ ES6+ ä»£ç å‹ç¼©ï¼Œä½†æ˜¯ç›®å‰ Roadhog é‡‡ç”¨çš„æ˜¯ Webpack3+ï¼‰ã€‚

[æ„å»ºé€Ÿåº¦æ…¢çš„è§£å†³æ–¹æ³•@sorrycc](https://hackmd.io/YHK_yuRtT0ePPVLY0_kUzw)

ä½“ç°ç‰¹å¾ï¼š

- æ„å»ºé€Ÿåº¦æ…¢
- å†…å­˜æ¶ˆè€—é«˜

è§£å†³æ–¹æ³•ï¼š

- å‡å°‘ä¾èµ–æ–‡ä»¶
  - ä¼˜åŒ– common æå–ç­–ç•¥ï¼Œè®©æ•´ä½“å°ºå¯¸å°½å¯èƒ½å°‘
  - externals æ‰ä¸€äº›å¤§çš„åº“ï¼Œé™ä½æ•´ä½“å°ºå¯¸
  - åˆ©ç”¨ webpack çš„ TreeShaking + es moduleï¼Œæ’é™¤æ‰ä¸€äº›æ²¡æœ‰ç”¨åˆ°çš„æ¨¡å—
- å‡å°‘éœ€è¦å‹ç¼©çš„æ–‡ä»¶

### å¤–éƒ¨æ‰©å±•

externals æ˜¯éå¸¸æœ‰æ•ˆçš„ä¸€ä¸ªæ–¹æ¡ˆï¼Œå¯ä»¥ä¸€ä¸‹å­å‡å°‘å¤§é‡éœ€è¦ç¼–è¯‘ã€å‹ç¼©çš„æ¨¡å—ã€‚å°†ä¸€äº›ä¸å¸¸æ›´æ–°ç‰ˆæœ¬æ¯”è¾ƒç¨³å®šçš„æ¨¡å—æ–‡ä»¶ç›´æ¥æ³¨å…¥ HMTL æ–‡ä»¶ï¼Œå½“è¯»å–åˆ°è¯¥è„šæœ¬æ—¶å°†è‡ªåŠ¨åŠ è½½ï¼Œè¿™ä¸ä»…èƒ½åŠ å¿«æ„å»ºé€Ÿåº¦ï¼Œè€Œä¸”èƒ½å¤Ÿåˆ©ç”¨ CDN è¿›è¡Œèµ„æºç¼“å­˜ã€‚

ä½†æ˜¯ä¼šå¸¦æ¥çš„é—®é¢˜æ˜¯ï¼š

- æ— æ³•åˆ©ç”¨ Webpack çš„ Tree-Shaking
- å¤šä¸ªåº“ä¹‹é—´å¦‚æœå­˜åœ¨å…¬å…±æ¨¡å—ï¼ˆæ¯”å¦‚ lodashï¼‰ï¼Œå°±æ— æ³•å¤ç”¨

ä½¿ç”¨ externals éœ€è¦åœ¨ HTML é‡Œå¼•ç”¨é¢å¤–çš„ JS æ–‡ä»¶ï¼Œè¿™é‡Œä¹Ÿæœ‰å‡ ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼š

- å¦‚æœä½ çš„ CDN ä¸æ”¯æŒ Comboï¼Œå¹¶ä¸”ä¸æ˜¯ http/2ï¼Œé‚£ä¹ˆé€Ÿåº¦ä¼šå¾ˆæ…¢
- ä½ éœ€è¦æ‰‹åŠ¨ç»´æŠ¤ä¸€ä»½ CDN æ–‡ä»¶åˆ—è¡¨ï¼Œå¹¶ä¸”è·Ÿè¿›ä»–ä»¬çš„æ›´æ–°ï¼Œä¹Ÿæ˜¯ä»¶éº»çƒ¦çš„äº‹æƒ…

è¿™é‡Œä¸»è¦å°†ä¸‰ä¸ªå°ºå¯¸è¾ƒå¤§ä¸”æ¯”è¾ƒå°‘é¡¹ç›®é¡µé¢å¼•ç”¨çš„æ¨¡å— externals æ‰ã€‚

```js
externals: {
    'ali-oss': 'window.OSS',
    'react': 'window.react',
    'react-dom': 'window.ReactDOM'
}
```

### é¡¹ç›®æ ·å¼æ–‡ä»¶å‡å°‘

ExtractTextPlugin æå– CSS (antd + ä¸šåŠ¡)

èƒ½ç”¨å…¬å…±å°±ç”¨å…¬å…±ï¼ˆå› ä¸ºå¤§éƒ¨åˆ†çš„é¡µé¢çš„æ ·å¼å‡ ä¹ä¸€æ ·ï¼‰ï¼Œä¸ç„¶æ¯ä¸ªé¡µé¢å¼€ä¸€ä¸ª less å¼•ç”¨å…¬å…±ï¼Œä¼šé‡å¤æ‰“åŒ…ï¼Œé€ æˆå†—ä½™ã€‚

### Gzip ä¼ è¾“å‹ç¼©

gzip éœ€è¦åœ¨æœåŠ¡å™¨é…ç½®å¼€å¯

è¿™é‡Œæä¾›ä¸€ç§ Nginx çš„é…ç½®ã€‚[ä¼ é€é—¨](https://blog.csdn.net/qq_36030288/article/details/54576503)

[å‰ç«¯æ€§èƒ½ä¼˜åŒ–ï¼šgzip å‹ç¼©æ–‡ä»¶ä¼ è¾“æ•°æ®](https://www.cnblogs.com/zs-note/p/9556390.html)

## ä¼˜åŒ–æ•ˆæœåˆ†æ

![ä¼˜åŒ–æ•ˆæœåˆ†æ](http://img.mrsingsing.com/roadhog-performance-optimizition-result.jpg)

- å¼€å‘ä½“éªŒï¼š70s => 20s å¯åŠ¨é¡¹ç›®æ—¶é—´æå‡ 71%
- æ„å»ºé€Ÿåº¦ï¼š382s => 40s é¡¹ç›®æ„å»ºé€Ÿåº¦æå‡ 89%
- èµ„æºæ–‡ä»¶ï¼š88Mbï¼ˆæœªå¼€å¯ Gzipï¼‰ => 25Mbï¼ˆå¼€å¯ Gzipï¼‰ => 1Mbï¼ˆä¼˜åŒ–åå¼€å¯ Gzipï¼‰ èµ„æºæ–‡ä»¶å°ºå¯¸å¤§å¹…åº¦é™ä½

## åç»­éœ€è¦è§£å†³çš„é—®é¢˜

### å•ç‹¬æ‰“åŒ…çš„ AntDesign å°ºå¯¸è¿‡å¤§

- å¯è§†åŒ–åˆ†æå°ºå¯¸è¾ƒå¤§çš„æ–‡ä»¶åŒ…æ‹¬ rc-editor-core / draft.js ç­‰
- é€šè¿‡ä¾èµ–æ‰¾åˆ°æ ¹æºæ˜¯ rc-editor-mention => rc-editor-core => draft-js æ¥è‡ª Mention ç»„ä»¶ï¼Œä½†æ˜¯é¡¹ç›®ä¸­å¹¶æ²¡æœ‰ä½¿ç”¨åˆ°
- å¾—å‡ºç»“æœæå–æ‰“åŒ…å°†æ•´ä¸ªç»„ä»¶åº“éƒ½æ‰“åŒ…è¿›æ¥äº†

ç¤¾åŒºä¸­æœ‰ååº”å¸Œæœ›æå–å…¬å…±æ¨¡å—æ‰“åŒ…æ—¶å°†å…¶ä¸­æŸäº›éƒ¨åˆ†å¿½ç•¥ä¸æ‰“åŒ…ï¼Œè€Œç»´æŠ¤è€…ä¼¼ä¹å‘ŠçŸ¥éœ€è¦ä½¿ç”¨ `babel-plugin-import` æŒ‰éœ€å¼•ç”¨ï¼Œå¹¶æ²¡æä¾›æå–å…¬å…±æ¨¡å—çš„è§£å†³æ–¹æ¡ˆã€‚ [ä¼ é€é—¨](https://github.com/ant-design/ant-design/issues/10180)

## å‚è€ƒèµ„æ–™

- [æ”¯æŒ vendor çš„é…ç½® Issue #370](https://github.com/sorrycc/roadhog/issues/370)
- [roadhog2 å¦‚ä½•æˆåŠŸæå– vendor Â· Issue #577](https://github.com/sorrycc/roadhog/issues/577)
- [ç¼–è¯‘å¾ˆæ…¢ #722](https://github.com/sorrycc/roadhog/issues/722)
- [roadhog 1.3x æ‰“åŒ…æ…¢çš„è§£å†³åŠæ³•](https://github.com/liangxinwei/blog/blob/master/webpack/2.md)
- [Roadhog æ„å»ºä¼˜åŒ–](http://www.mamicode.com/info-detail-2413081.html)
- [JS/CSS ä½“ç§¯å‡å°‘äº† 67%ï¼Œæˆ‘ä»¬æ˜¯å¦‚ä½•åšåˆ°çš„ï¼Ÿ](https://www.itcodemonkey.com/article/12011.html)
- [Webpack æ—¥å¸¸ä½¿ç”¨ä¸ä¼˜åŒ–](https://github.com/creeperyang/blog/issues/37)
